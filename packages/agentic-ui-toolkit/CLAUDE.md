# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Overview

This is a custom shadcn component registry built with Next.js 15 and Tailwind v4. It allows distributing custom components, hooks, pages, and other files to any React project using the `shadcn` CLI.

## Commands

```bash
# Development server (uses Turbopack)
pnpm run dev

# Build the Next.js app
pnpm run build

# Build the registry (generates static JSON files)
pnpm run registry:build

# Lint
pnpm run lint
```

## Architecture

### Registry System

The registry is defined in `registry.json` and uses the shadcn registry schema. Each registry item specifies:

- `name`: Component identifier (used in `shadcn add <name>`)
- `type`: Usually `registry:component`
- `files`: Array of file paths with their types (`registry:component`, `registry:page`, `registry:lib`, `registry:hook`)
- `dependencies`: npm packages required
- `registryDependencies`: Other registry items this depends on (e.g., `button`, `card`)

### Directory Structure

- `registry/misc/` - Custom composite components
- `components/ui/` - Base UI primitives (button, card) for local development
- `app/` - Next.js app router pages for previewing components
- `public/r/[name].json` - Built registry items served as static files (generated by `registry:build`)

### Component Style

Uses shadcn style with:

- Tailwind CSS v4
- CSS variables for theming
- Lucide icons
- Server Components enabled (RSC: true)

### Adding New Components

1. Create component files in `registry/misc/<component-name>/`
2. Add entry to `registry.json` with proper file paths and dependencies
3. Run `pnpm run registry:build` to generate the distributable JSON
4. Import in `app/page.tsx` to preview

## Analytics Tracking (Vercel)

**IMPORTANT**: When adding or updating blocks, maintain Vercel Analytics tracking for user interactions.

### Pricing Constraint

**CRITICAL**: Our Vercel plan includes custom events with **maximum 2 properties per event**. Additional events beyond the plan limit cost $30 per 1M events. Always limit tracking to 2 properties maximum.

### Existing Tracking Events

The following events are tracked via `@vercel/analytics`:

| Event Name | Properties (max 2) | Location |
|-----------|------------|----------|
| `install_command_copied` | `{ command, inline: boolean }` | `components/blocks/install-commands.tsx`, `components/blocks/install-command-inline.tsx` |
| `code_copied` | `{ code }` | `components/blocks/code-block.tsx` |

### When Adding New Blocks

1. **Use existing components**: When displaying install commands, use `<InstallCommands>` or `<InstallCommandInline>` components - they already have tracking built-in
2. **Use CodeBlock for code display**: The `<CodeBlock>` component tracks code copies automatically
3. **New interaction types**: If adding a new type of user interaction (not copy), add tracking using:
   ```tsx
   import { track } from '@vercel/analytics'

   // Track the event - MAXIMUM 2 PROPERTIES
   track('event_name', { property1: 'value1', property2: 'value2' })
   ```
4. **Consistency**: Keep event names snake_case and properties descriptive
5. **Property limit**: Never exceed 2 properties per event to stay within the Vercel Analytics free tier
