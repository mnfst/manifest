# ============================================================================
# Changeset PR Check Workflow
# ============================================================================
# Reports a passing "test" status for automated changeset PRs.
#
# Why this exists:
# 1. Changeset PRs are created by github-actions[bot] using GITHUB_TOKEN
# 2. Workflows triggered by GITHUB_TOKEN don't trigger other workflows
# 3. This causes the required "test" check to hang on "Waiting for status"
#
# Solution:
# - Use pull_request_target which runs even for bot-created PRs
# - Use the same job name "test" to satisfy the required status check
# - Only runs for PRs titled "chore: version packages"
# ============================================================================

name: Changeset PR Check

permissions:
  contents: read
  statuses: write

on:
  pull_request_target:
    branches: [main]

jobs:
  test:
    name: test
    runs-on: ubuntu-latest
    # Only run for changeset PRs (identified by title)
    if: github.event.pull_request.title == 'chore: version packages'

    steps:
      - name: Skip tests for version packages PR
        run: |
          echo "âœ… Skipping tests - changeset PR only changes version numbers"
          echo ""
          echo "This PR was created by the changesets automation and only"
          echo "updates package versions and changelogs. No code tests needed."
